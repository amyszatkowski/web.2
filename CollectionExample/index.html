<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Collection Example</title>
  <script src='https://code.jquery.com/jquery-2.1.3.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/packery.pkgd.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/tabletop.js'></script>
  <script src='http://cykod.github.io/Collection.js/collection.js'></script>
  <script src="imagesloaded.pkgd.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="stylesheet.css" type="text/css" charset="utf-8" />
</head>
<body>

<div id='logoContainer'> 
  <img src="Porcelain.png" id='logo'> 
</div>


<div id='filter-bar-wrapper'>
  <div id='filter-bar'>
    

  <h5>Filter</h5>
  <h6>Series</h6>

    
    <button data-category="blossom"   class='category'>Blossom</button>
    <button data-category="dotted"    class='category'>Dotted</button>
    <button data-category="hexagon"   class='category'>Hexagon</button>

    <button data-category=""          class='category selected' id="all-button">See All</button>

  <h6>Season</h6>
    
    <button data-season="Spring 2013" class='season'>Spring 2013</button>
    <button data-season="Spring 2014" class='season'>Spring 2014</button>
    <button data-season="Fall 2014" class='season'>Fall 2014</button>

    <button data-season="" class='season selected' id="all-button">See All</button>

    <input type='text' id='search' placeholder='search'/>

  </div>
</div>

<div id='collectionWrapper'>

<ul class='collection'>
 


</ul>

</div>

<div class='overlay'></div>
<div class='modal'></div>
<script>


function showModal(item) {
   $(".modal").empty();
   
   var $h1 = $("<h1>").text(item.Name);
   var $img = $("<img>").attr("src",item.PhotoFull);
   var $p = $("<p class='description'>").html(item.Name + "<br>" + item.Season + "<br>" + item.Glaze + "<br>" + item.Series);

   $(".modal").append($h1,$img,$p);
   
   $(".overlay").show();
   $(".modal").show();

}

function hideModal() {
  $(".overlay").hide(); 
  $(".modal").hide();
}

function addItem(item) {
  var $li = $("<div>").addClass("item").addClass(item.Description);

  $li.attr("data-category",item.Series);
  $li.attr("data-season",item.Season);
  $li.attr("data-search", item.Series + " " + item.Season + " " + item.Name + " " + item.Glaze);

  var $img = $("<img class='thumbnail'>").attr("src",item.Photo);

  $li.append($img);

  $li.on("click",function(e) {
      showModal(item);
  });

  $(".collection").append($li);
};

function addItems(data) {
  for(var i=0;i<data.length;i++) {
    addItem(data[i]);
  }
}


function callback(data) { 

  addItems(data);

  var $container = $('.collection');
  $container.imagesLoaded( function() {
  $container.packery({
    itemSelector: '.item',
    gutter: 10
  }); });

  var myCollection = $(".item").collection({
    filters: { 
      "title": "[data-search]",
      "category": "[data-category]",
      "season": "[data-season]"
    },

    update: function() { 
      $container.packery(); 
      setTimeout(function() { $container.packery()},600);
    },
    hide: function($elem) { $elem.hide(); },
    show: function($elem) { $elem.fadeIn(500); },
  });

  $(".category").on("click",function(e) {
      var category = $(this).data("category");
      $("#filter-bar button").removeClass("selected");
      $(this).addClass("selected");
      myCollection.filtered("category",category);
  });

  $(".season").on("click",function(e) {
      var season = $(this).data("season");
      $("#filter-bar button").removeClass("selected");
      $(this).addClass("selected");
      myCollection.filtered("season", season);
  });

  $("#search").on("change keyup",function(e) {
      myCollection.filtered("title", $(this).val());
  });

  $(".overlay").on("click",function(e) {
      hideModal();
  });

}


  Tabletop.init( { key: "https://docs.google.com/spreadsheets/d/1FqMoG3i7m_AMmbDneHmzgEcMeibyzpO0479Xs82oOzk/pubhtml?gid=0&single=true",
                   callback: callback,
                   simpleSheet: true } )


</script>
	
</body>
</html>
